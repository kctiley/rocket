/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("datatype-xml-parse",function(e,t){e.mix(e.namespace("XML"),{parse:function(t){var n=null,r;return typeof t=="string"&&(r=e.config.win,r.ActiveXObject!==undefined?(n=new ActiveXObject("Microsoft.XMLDOM"),n.async=!1,n.loadXML(t)):r.DOMParser!==undefined?n=(new DOMParser).parseFromString(t,"text/xml"):r.Windows!==undefined&&(n=new Windows.Data.Xml.Dom.XmlDocument,n.loadXml(t))),n===null||n.documentElement===null||n.documentElement.nodeName==="parsererror",n}}),e.namespace("Parsers").xml=e.XML.parse,e.namespace("DataType"),e.DataType.XML=e.XML},"3.16.0");
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("io-xdr",function(e,t){function a(e,t,n){var r='<object id="io_swf" type="application/x-shockwave-flash" data="'+e+'" width="0" height="0">'+'<param name="movie" value="'+e+'">'+'<param name="FlashVars" value="yid='+t+"&uid="+n+'">'+'<param name="allowScriptAccess" value="always">'+"</object>",i=s.createElement("div");s.body.appendChild(i),i.innerHTML=r}function f(t,n,r){return n==="flash"&&(t.c.responseText=decodeURI(t.c.responseText)),r==="xml"&&(t.c.responseXML=e.DataType.XML.parse(t.c.responseText)),t}function l(e,t){return e.c.abort(e.id,t)}function c(e){return u?i[e.id]!==4:e.c.isInProgress(e.id)}var n=e.publish("io:xdrReady",{fireOnce:!0}),r={},i={},s=e.config.doc,o=e.config.win,u=o&&o.XDomainRequest;e.mix(e.IO.prototype,{_transport:{},_ieEvt:function(e,t){var n=this,r=e.id,s="timeout";e.c.onprogress=function(){i[r]=3},e.c.onload=function(){i[r]=4,n.xdrResponse("success",e,t)},e.c.onerror=function(){i[r]=4,n.xdrResponse("failure",e,t)},e.c.ontimeout=function(){i[r]=4,n.xdrResponse(s,e,t)},e.c[s]=t[s]||0},xdr:function(t,n,i){var s=this;return i.xdr.use==="flash"?(r[n.id]=i,o.setTimeout(function(){try{n.c.send(t,{id:n.id,uid:n.uid,method:i.method,data:i.data,headers:i.headers})}catch(e){s.xdrResponse("transport error",n,i),delete r[n.id]}},e.io.xdr.delay)):u?(s._ieEvt(n,i),n.c.open(i.method||"GET",t),setTimeout(function(){n.c.send(i.data)},0)):n.c.send(t,n,i),{id:n.id,abort:function(){return n.c?l(n,i):!1},isInProgress:function(){return n.c?c(n.id):!1},io:s}},xdrResponse:function(e,t,n){n=r[t.id]?r[t.id]:n;var s=this,o=u?i:r,a=n.xdr.use,l=n.xdr.dataType;switch(e){case"start":s.start(t,n);break;case"success":s.success(f(t,a,l),n),delete o[t.id];break;case"timeout":case"abort":case"transport error":t.c={status:0,statusText:e};case"failure":s.failure(f(t,a,l),n),delete o[t.id]}},_xdrReady:function(t,r){e.fire(n,t,r)},transport:function(t){t.id==="flash"&&(a(e.UA.ie?t.src+"?d="+(new Date).valueOf().toString():t.src,e.id,t.uid),e.IO.transports.flash=function(){return s.getElementById("io_swf")})}}),e.io.xdrReady=function(t,n){var r=e.io._map[n];e.io.xdr.delay=0,r._xdrReady.apply(r,[t,n])},e.io.xdrResponse=function(t,n,r){var i=e.io._map[n.uid];i.xdrResponse.apply(i,[t,n,r])},e.io.transport=function(t){var n=e.io._map["io:0"]||new e.IO;t.uid=n._uid,n.transport.apply(n,[t])},e.io.xdr={delay:100}},"3.16.0",{requires:["io-base","datatype-xml-parse"]});
YUI.add("site-key",function(e){"use strict";e.SiteKey=function(t,n){this.configurator=t||null,this.flickrAPI=n||new e.FlickrAPI,this._tasks=[]},e.SiteKey.prototype.getKey=function(){return e.config.flickr.api.site_key},e.SiteKey.prototype.isExpired=function(){return Date.now()/1e3>e.config.flickr.api.site_key_expiresAt},e.SiteKey.prototype.invalidate=function(e){var t=this._lastStored||0;e||(e=0);if(e<t)return;return this.setExpired()},e.SiteKey.prototype.setExpired=function(){return e.config.flickr.api.site_key_expiresAt=0},e.SiteKey.prototype.store=function(t,n){var r;this._lastStored=Date.now(),n||(n=this._lastStored/1e3|0),e.config.flickr.api.site_key=t,e.config.flickr.api.site_key_fetched=n,e.config.flickr.api.site_key_expiresAt=e.config.flickr.api.site_key_fetched+e.config.flickr.api.site_key_fetch_interval,this.configurator&&(r={},r.site_key=t,r.site_key_fetched=n,this.configurator.update({api:r})),this.drainQueue()},e.SiteKey.prototype.setTrustedKey=function(e){this._trustedKey=e},e.SiteKey.prototype.getTrustedKey=function(){return this._trustedKey||null},e.SiteKey.prototype._humanizeDuration=function(e){var t=Math.round(e/60),n=Math.round(t/60),r=Math.round(n/24),i=Math.round(r/365),s=e<45&&["%d seconds",e]||t===1&&["a minute"]||t<45&&["%d minutes",t]||n===1&&["an hour"]||n<22&&["%d hours",n]||r===1&&["a day"]||r<=25&&["%d days",r]||r<=45&&["a month"]||r<345&&["%d months",Math.round(r/30)]||i===1&&["a year"]||["%d years",i];return s.length>1?s[0].replace(/%d/i,s[1]):s[0]},e.SiteKey.prototype.pushToQueue=function(e){this._tasks.push(e)},e.SiteKey.prototype.drainQueue=function(){while(this._tasks.length)this._tasks.shift().resolve()},e.SiteKey.prototype.hasQueuedTasks=function(){return!!this._tasks.length},e.SiteKey.prototype.scheduleFutureFetch=function(){this._timerFutureFetch=setTimeout(this.fetch.bind(this),e.config.flickr.api.site_key_fetch_interval*1e3)},e.SiteKey.prototype.scheduleRetry=function(t){var n=this,r=this._fetchRuns>4?1:Math.pow(2,(this._fetchRuns||1)-1)/10,i=e.config.flickr.api.site_key_retry_interval*r;clearTimeout(this._timerRetry),this._timerRetry=setTimeout(function(){n._timerRetry=null,n.fetch(t)},i*1e3)},e.SiteKey.prototype.fetch=function(t){clearTimeout(this._timerFutureFetch);var n,r=this,i=r.hasQueuedTasks();if(!t){t=new e.Promise(function(e,t){this.resolve=e,this.reject=t}),this.pushToQueue(t);if(i)return t}return n=e.fletrics.createStopwatch("test.site.key.api.latency"),n.start(),this._fetchRuns||(this._fetchRuns=0),this._fetchRuns++,this.flickrAPI.fetchSiteKey().then(function(t){var i=t.site_key;n.stop(),e.Flog.debug("[site key] Received new site key: "+i+", we will fetch a new site key in "+r._humanizeDuration(e.config.flickr.api.site_key_fetch_interval)),r._fetchRuns=0,r.store(i),e.fire("site-key:goodkey"),e.fletrics.sync(),r.scheduleFutureFetch()},function(n){e.fletrics.increment("sitekey.fetch.failures"),e.fire("site-key:badkey"),e.Flog.error("[site key] Failed to fetch site key: "+n.message+", we will retry in "+r._humanizeDuration(e.config.flickr.api.site_key_retry_interval)),r.scheduleRetry(t)}),t},e.augment(e.SiteKey,e.EventTarget)},"@VERSION@",{requires:["event-custom","flickr-api","flickr-promise","flog","fletrics"]});
YUI.add("csrf-updater",function(e){"use strict";e.CsrfUpdater=function(e){this.flickrAPI=e,this._tasks=[]},e.CsrfUpdater.prototype.getKey=function(){return e.config.flickr.csrf.token||null},e.CsrfUpdater.prototype.isExpired=function(){return e.config.flickr.csrf.token?Date.now()/1e3>e.config.flickr.csrf.csrfExpiresAt:!1},e.CsrfUpdater.prototype.invalidate=function(e){var t=this._lastStored||0;e||(e=0);if(e<t)return;return this.setExpired()},e.CsrfUpdater.prototype.setExpired=function(){return e.config.flickr.csrf.csrfExpiresAt=0},e.CsrfUpdater.prototype.store=function(t,n){this._lastStored=Date.now(),n||(n=this._lastStored/1e3|0),e.config.flickr.csrf.token=t,e.config.flickr.csrf.csrfFetched=n,e.config.flickr.csrf.csrfExpiresAt=n+e.config.flickr.csrf.fetch_interval,this.drainQueue()},e.CsrfUpdater.prototype._humanizeDuration=function(e){var t=Math.round(e/60),n=Math.round(t/60),r=Math.round(n/24),i=Math.round(r/365),s=e<45&&["%d seconds",e]||t===1&&["a minute"]||t<45&&["%d minutes",t]||n===1&&["an hour"]||n<22&&["%d hours",n]||r===1&&["a day"]||r<=25&&["%d days",r]||r<=45&&["a month"]||r<345&&["%d months",Math.round(r/30)]||i===1&&["a year"]||["%d years",i];return s.length>1?s[0].replace(/%d/i,s[1]):s[0]},e.CsrfUpdater.prototype.pushToQueue=function(e){this._tasks.push(e)},e.CsrfUpdater.prototype.drainQueue=function(){while(this._tasks.length)this._tasks.shift().resolve()},e.CsrfUpdater.prototype.hasQueuedTasks=function(){return!!this._tasks.length},e.CsrfUpdater.prototype.scheduleFutureFetch=function(){if(!e.config.flickr.csrf.token)return;this._timerFutureFetch=setTimeout(this.fetch.bind(this),e.config.flickr.csrf.fetch_interval*1e3)},e.CsrfUpdater.prototype.scheduleRetry=function(t){var n=this,r=this._fetchRuns>4?1:Math.pow(2,(this._fetchRuns||1)-1)/10,i=e.config.flickr.csrf.retry_interval*r;clearTimeout(this._timerRetry),this._timerRetry=setTimeout(function(){n._timerRetry=null,n.fetch(t)},i*1e3)},e.CsrfUpdater.prototype.fetch=function(t){var n=this,r=n.hasQueuedTasks();clearTimeout(this._timerFutureFetch);if(!t){t=new e.Promise(function(e,t){this.resolve=e,this.reject=t}),this.pushToQueue(t);if(r)return t}return this._fetchRuns||(this._fetchRuns=0),this._fetchRuns++,this.flickrAPI.fetchCsrf().then(function(t){var r=t.token;e.Flog.debug("[csrf] Received new csrf: "+r+", we will fetch a new csrf token in "+n._humanizeDuration(e.config.flickr.csrf.fetch_interval)),e.fire("csrf:goodkey"),n._fetchRuns=0,n.store(r),n.scheduleFutureFetch()},function(r){e.Flog.error("[csrf] Failed to fetch csrf token: "+r.message+", we will retry in "+n._humanizeDuration(e.config.flickr.csrf.retry_interval)),e.fire("csrf:badkey",r.message),n.scheduleRetry(t)}),t}},"@VERSION@",{requires:["flog","fletrics"]});
YUI.add("samplr",function(e){var t=1e3;e.Samplr=function(e){this.seed=e||Math.round(Math.random()*t)},e.Samplr.prototype.isInSample=function(e){return this.seed<=Math.round(e*t)?!0:!1}},"@VERSION@",{requires:["app-context"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("io-form",function(e,t){var n=encodeURIComponent;e.IO.stringify=function(t,n){n=n||{};var r=e.IO.prototype._serialize({id:t,useDisabled:n.useDisabled},n.extra&&typeof n.extra=="object"?e.QueryString.stringify(n.extra):n.extra);return r},e.mix(e.IO.prototype,{_serialize:function(t,r){var i=[],s=t.useDisabled||!1,o=0,u=typeof t.id=="string"?t.id:t.id.getAttribute("id"),a,f,l,c,h,p,d,v,m,g;u||(u=e.guid("io:"),t.id.setAttribute("id",u)),f=e.config.doc.getElementById(u);if(!f||!f.elements)return r||"";for(p=0,d=f.elements.length;p<d;++p){a=f.elements[p],h=a.disabled,l=a.name;if(s?l:l&&!h){l=n(l)+"=",c=n(a.value);switch(a.type){case"select-one":a.selectedIndex>-1&&(g=a.options[a.selectedIndex],i[o++]=l+n(g.attributes.value&&g.attributes.value.specified?g.value:g.text));break;case"select-multiple":if(a.selectedIndex>-1)for(v=a.selectedIndex,m=a.options.length;v<m;++v)g=a.options[v],g.selected&&(i[o++]=l+n(g.attributes.value&&g.attributes.value.specified?g.value:g.text));break;case"radio":case"checkbox":a.checked&&(i[o++]=l+c);break;case"file":case undefined:case"reset":case"button":break;case"submit":default:i[o++]=l+c}}}return r&&(i[o++]=r),i.join("&")}},!0)},"3.16.0",{requires:["io-base","node-base"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("io-upload-iframe",function(e,t){function u(t,n,r){var i=e.Node.create('<iframe id="io_iframe'+t.id+'" name="io_iframe'+t.id+'" />');i._node.style.position="absolute",i._node.style.top="-1000px",i._node.style.left="-1000px",e.one("body").appendChild(i),e.on("load",function(){r._uploadComplete(t,n)},"#io_iframe"+t.id)}function a(t){e.Event.purgeElement("#io_iframe"+t,!1),e.one("body").removeChild(e.one("#io_iframe"+t))}var n=e.config.win,r=e.config.doc,i=r.documentMode&&r.documentMode>=8,s=decodeURIComponent,o=e.IO.prototype.end;e.mix(e.IO.prototype,{_addData:function(t,n){e.Lang.isObject(n)&&(n=e.QueryString.stringify(n));var i=[],o=n.split("="),u,a;for(u=0,a=o.length-1;u<a;u++)i[u]=r.createElement("input"),i[u].type="hidden",i[u].name=s(o[u].substring(o[u].lastIndexOf("&")+1)),i[u].value=u+1===a?s(o[u+1]):s(o[u+1].substring(0,o[u+1].lastIndexOf("&"))),t.appendChild(i[u]);return i},_removeData:function(e,t){var n,r;for(n=0,r=t.length;n<r;n++)e.removeChild(t[n])},_setAttrs:function(t,n,r){this._originalFormAttrs={action:t.getAttribute("action"),target:t.getAttribute("target")},t.setAttribute("action",r),t.setAttribute("method","POST"),t.setAttribute("target","io_iframe"+n),t.setAttribute(e.UA.ie&&!i?"encoding":"enctype","multipart/form-data")},_resetAttrs:function(t,n){e.Object.each(n,function(e,n){e?t.setAttribute(n,e):t.removeAttribute(n)})},_startUploadTimeout:function(e,t){var r=this;r._timeout[e.id]=n.setTimeout(function(){e.status=0,e.statusText="timeout",r.complete(e,t),r.end(e,t)},t.timeout)},_clearUploadTimeout:function(e){var t=this;n.clearTimeout(t._timeout[e]),delete t._timeout[e]},_uploadComplete:function(t,r){var i=this,s=e.one("#io_iframe"+t.id).get("contentWindow.document"),o=s.one("body"),u;r.timeout&&i._clearUploadTimeout(t.id);try{o?(u=o.one("pre:first-child"),t.c.responseText=u?u.get("text"):o.get("text")):t.c.responseXML=s._node}catch(f){t.e="upload failure"}i.complete(t,r),i.end(t,r),n.setTimeout(function(){a(t.id)},0)},_upload:function(t,n,i){var s=this,o=typeof i.form.id=="string"?r.getElementById(i.form.id):i.form.id,u;return s._setAttrs(o,t.id,n),i.data&&(u=s._addData(o,i.data)),i.timeout&&s._startUploadTimeout(t,i),o.submit(),s.start(t,i),i.data&&s._removeData(o,u),{id:t.id,abort:function(){t.status=0,t.statusText="abort";if(!e.one("#io_iframe"+t.id))return!1;a(t.id),s.complete(t,i),s.end(t,i)},isInProgress:function(){return e.one("#io_iframe"+t.id)?!0:!1},io:s}},upload:function(e,t,n){return u(e,n,this),this._upload(e,t,n)},end:function(e,t){var n,i;return t&&(n=t.form,n&&n.upload&&(i=this,n=typeof n.id=="string"?r.getElementById(n.id):n.id,n&&i._resetAttrs(n,this._originalFormAttrs))),o.call(this,e,t)}},!0)},"3.16.0",{requires:["io-base","node-base"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("queue-promote",function(e,t){e.mix(e.Queue.prototype,{indexOf:function(t){return e.Array.indexOf(this._q,t)},promote:function(e){var t=this.indexOf(e);t>-1&&this._q.unshift(this._q.splice(t,1)[0])},remove:function(e){var t=this.indexOf(e);t>-1&&this._q.splice(t,1)}})},"3.16.0",{requires:["yui-base"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("io-queue",function(e,t){function r(e,t){return n.queue.apply(n,[e,t])}var n=e.io._map["io:0"]||new e.IO;e.mix(e.IO.prototype,{_q:new e.Queue,_qActiveId:null,_qInit:!1,_qState:1,_qShift:function(){var e=this,t=e._q.next();e._qActiveId=t.id,e._qState=0,e.send(t.uri,t.cfg,t.id)},queue:function(t,n){var r=this,i={uri:t,cfg:n,id:this._id++};return r._qInit||(e.on("io:complete",function(e,t){r._qNext(e)},r),r._qInit=!0),r._q.add(i),r._qState===1&&r._qShift(),i},_qNext:function(e){var t=this;t._qState=1,t._qActiveId===e&&t._q.size()>0&&t._qShift()},qPromote:function(e){this._q.promote(e)},qRemove:function(e){this._q.remove(e)},qEmpty:function(){this._q=new e.Queue},qStart:function(){var e=this;e._qState=1,e._q.size()>0&&e._qShift()},qStop:function(){this._qState=0},qSize:function(){return this._q.size()}},!0),r.start=function(){n.qStart()},r.stop=function(){n.qStop()},r.promote=function(e){n.qPromote(e)},r.remove=function(e){n.qRemove(e)},r.size=function(){n.qSize()},r.empty=function(){n.qEmpty()},e.io.queue=r},"3.16.0",{requires:["io-base","queue-promote"]});
YUI.add("rrd",function(e){"use strict";function n(n,r){if(!e.Lang.isString(r)){e.Flog.error("RRD beacon URL missing");return}if(!n)return;if(!t||!t.location||t.location.host!==e.config.flickr.url.host)return;e.io(r,{method:"GET",data:n,timeout:1e4,on:{end:function(){}}})}var t=e.config.win;e.RRD={queue:n}},"@VERSION@",{requires:["querystring-stringify","io"],affinity:"client"});
YUI.add("flickr-client-metrics",function(e){"use strict";function s(n){var r=1,s=t.appContext.getViewer().signedIn;if(e.config&&e.config.flickr){e.config.flickr.client_metrics_samples&&(r=e.config.flickr.client_metrics_samples["default"],e.config.flickr.client_metrics_samples[n]&&(r=typeof e.config.flickr.client_metrics_samples[n]=="object"?e.config.flickr.client_metrics_samples[n][s?"signedIn":"signedOut"]:e.config.flickr.client_metrics_samples[n]));if(e.config.flickr.request&&(e.config.flickr.request.UA.isBot||e.config.flickr.request.UA.isSharingBot))return!1}return i.isInSample(r)}function o(){var i=0,u={},a,f,l,c;if(!t.performance||!t.performance.timing||!t.pageTiming)return;t.pageTiming.timeAboveTheFold===-1||!t.performance.timing.loadEventEnd||!t.appContext||!t.appContext.flapp?i<100&&(i++,setTimeout(o,100)):(f=t.appContext.flapp.get("activeView"),n=t.appContext.getViewer().signedIn,a=t.performance.timing,c=t.pageTiming,f?f&&f.name&&(u.timing_pageid=t.appContext.flapp.get("activeView").name.replace(/-/g,"_")+"_coldstart",l=t.appContext.flapp.get("activeView").name.replace(/-/g,"_")):(u.timing_pageid="photo_page_view_coldstart",l="photo_page_view"),s(l)&&(u.page_start=a.responseStart,u.page_generation=t.pageGenEnd-t.pageGenStart,u.js_done=c.jsDone,u.AFT=c.timeAboveTheFold,u.window_load=a.loadEventEnd,u.dom_ready=a.domInteractive,u.is_logged_in=n,e.config.flickr.pathogen&&(u.pathogen=1),e.RRD.queue(u,r)))}function u(){}var t=e.config.win,n=!1,r="/beacon_page_timings.gne",i=new e.Samplr;t&&(t.sessionStart=(new Date).getTime()),e.FlickrClientMetrics=function(t){this.appContext=t,this.activeViewChanges=0,this.pendingMarks=[],this.pendingMeasurementsByView={},this.hasPendingMarks=!1,this.isPending=!1,this.data={},this.url=e.config.win.location.href,this.publish("beacon"),this.publish("page_start"),this.publish("js_done"),this.publish("mark"),this.publish("record"),this.publish("abort")},e.FlickrClientMetrics.gatherColdStartData=o,e.FlickrClientMetrics.gatherPaftData=u,e.FlickrClientMetrics.isInSample=s,e.FlickrClientMetrics.prototype={setPendingMeasurement:function(e,t){t?this.pendingMeasurementsByView[e]=t:delete this.pendingMeasurementsByView[e]},hasPendingMeasurements:function(){return!!Object.keys(this.pendingMeasurementsByView).length},clearPendingMeasurements:function(){this.pendingMeasurementsByView={}},setPendingMark:function(t){var n=this,r=new e.Promise(t);return this.hasPendingMarks=!0,r.then(function(e){typeof e=="string"&&n.mark(e)},function(t){e.Flog&&e.Flog.warn("ClientMetrics: Unable to set pending mark: ",t)}),this.pendingMarks.push(r),r},_handlePendingMarkSuccess:function(e){this.hasPendingMarks=!1,this.pendingMarks=[],Object.keys(this.data).length>0&&this.beacon()},_handlePendingMarkFailure:function(e){this.hasPendingMarks=!1,this.pendingMarks=[],this.data={},this.fire("abort")},beaconLater:function(){if(this.hasPendingMarks)return e.Promise.all(this.pendingMarks).then(this._handlePendingMarkSuccess.bind(this),this._handlePendingMarkFailure.bind(this));this.beacon()},getTimestamp:function(){return(new Date).getTime()},mark:function(e){return this.data[e]=this.getTimestamp(),this.fire("mark",{markName:e}),!0},markStart:function(e,t){t&&typeof t=="object"?t.markName=e:t={markName:e},this.fire("mark_start",t)},markEnd:function(e,t){t&&typeof t=="object"?t.markName=e:t={markName:e},this.fire("mark_end",t)},start:function(e){this.isPending=!0,this.url=e,this.data={},this.data.page_start=this.getTimestamp(),this.fire("page_start")},record:function(e,t){return this.data[e]=t,this.fire("record",{markName:e,timestamp:t}),!0},end:function(){var t=this.getTimestamp();if(!this.isPending){e.Flog&&e.Flog.warn("ClientMetrics: Calling `end` without calling `start`");return}this.data.dom_ready=t,this.data.js_done=t,this.data.page_generation=t-this.data.page_start,this.activeViewChanges++,this.data.active_view_changes=this.activeViewChanges,this.isPending=!1,this.fire("js_done"),this.beacon()},beacon:function(){var t=0,n,i;return e.config.win.location.href!==this.url?(this.fire("abort"),-1):this.isPending||this.hasPendingMarks||this.hasPendingMeasurements()?-1:Object.keys(this.data).length<1?(e.Flog&&e.Flog.warn("ClientMetrics: Trying to beacon with no data"),-1):(n=this.appContext.flapp.get("activeView"),i=n.name.replace(/-/g,"_"),this.data.timing_pageid=i+"_inpage",this.data.is_logged_in=this.appContext.getViewer().signedIn,this.data.spaceid=n.get("spaceid"),e.config.flickr.pathogen&&(this.data.pathogen=1),this.fire("beacon",{data:this.data}),s(i)&&(e.RRD.queue(this.data,r),t=1),this.data={},t)}},e.augment(e.FlickrClientMetrics,e.EventTarget,!0,null,{prefix:"metrics"})},"@VERSION@",{requires:["samplr","event-custom","flickr-promise","rrd"],affinity:"client"});
YUI.add("client-transport",function(e){"use strict";function l(e){var n;if(e.data.photo_id&&u.photos[e.data.photo_id]){for(n in u.photos[e.data.photo_id])t.unset(n);delete u.photos[e.data.photo_id]}if(e.data.user_id&&u.users[e.data.user_id]){for(n in u.users[e.data.user_id])t.unset(n);delete u.users[e.data.user_id]}}function c(e,t){var n;while(n=s.exec(t))u.photos[n[1]]||(u.photos[n[1]]={}),u.photos[n[1]][e]=e;while(n=o.exec(t))u.users[n[1]]||(u.users[n[1]]={}),u.users[n[1]][e]=e}function h(){var t="/hermes_error_beacon.gne";return new e.Promise(function(n,i){e.io(t,{method:"GET",timeout:r,on:{complete:function(e,t){var r;try{r=JSON.parse(t.responseText)||{}}catch(s){return i({status:0,message:"invalid JSON in response",resp:t})}if(!r.site_key)return i({status:0,message:"invalid JSON content, no site_key found",resp:t});n(r)}}})})}function p(t){var n={flickr:!0,data:{method:"flickr.site.getCsrf"}},r=t,i=this;return new e.Promise(function(e,t){this.resolve=function(t){e({token:t.token._content})},this.reject=t,m.call(i,r,n,this)})}function d(e,t){return v.call(this,e,t)}function v(t,n,r){var i,s=this;return i=function(){var o;return s.keys.siteKey.isExpired()?(o=s.keys.siteKey.fetch(),o=o.then(i),o):s.keys.csrf.isExpired()?(o=s.keys.csrf.fetch(),o=o.then(i),o):r?(m.call(s,t,n,r,v),r):new e.Promise(function(e,r){this.resolve=e,this.reject=r,m.call(s,t,n,this,v)})},i()}function m(n,s,o,u){var h,p,d,v,m=this,g,y,b,w;v=Math.round(Math.random()*1e11).toString(36),s=s||{},s.data=s.data||{},s.data.csrf=this.keys.csrf.getKey(),s.data.api_key=this.keys.siteKey.getKey(),s.method=s.method||"GET",s.data.format="json",s.data.hermes=1,s.data.hermesClient=1,s.data.reqId=v,h=n,d=h+JSON.stringify(s.data),s.data.method&&s.data.method.match(a)&&(s.method="POST",l(s)),p=t.get(d);if(p)return e.when(p,o.resolve);s.data.nojsoncallback=1,this._authRetry=this._authRetry||0,this._authRetry++,g=(new Date).getTime(),y=s.data.method,b=s.data,w={method:s.method,data:s.data,timeout:s.timeout||r,xdr:{use:"native",credentials:!0},on:{complete:function(r,a){var l={},h=f.exclude[s.data.method]===!0,p=f.include[s.data.method]!==!1,w=(new Date).getTime();l.reqId=v;if(a.status===404){o.resolve({status:404}),l.apiMethod=y,e.fire("client-transport:apiError",l);return}if(a.status===0){o.reject({status:0,resp:a,message:"XHR error"}),l.apiMethod=y,e.fire("client-transport:apiError",l);return}try{l=JSON.parse(a.responseText)||{}}catch(E){o.reject({status:0,message:"invalid JSON in response",resp:a}),l.apiMethod=y,e.fire("client-transport:apiError",l);return}if(l.stat!=="ok"){l.code=Number(l.code);if(u&&[98,99,100].indexOf(l.code)>=0&&m._authRetry<i){l.code===98&&m.keys.csrf.invalidate(g),m.keys.siteKey.invalidate(g),u.call(m,n,s,o);return}return l.apiMethod=y,e.fire("client-transport:apiError",l),y==="flickr.site.getCsrf"?o.reject(l):o.resolve(l)}e.soon(function(){e.fire("client-transport:apiTime",{start:g,end:w,method:b.method})}),m._authRetry=0,o.resolve(l);if(s.method!=="GET")return;p&&!h&&(c(d,a.responseText),t.set(d,l))},start:function(){},end:function(){},failure:function(t,n){e.soon(function(){n.apiMethod=y,n.reqId=v,n.transportFailure=!0,e.fire("client-transport:apiError",n)}),o.reject(n)}}},e.io(h,w)}var t=e.betterCache,n,r=3e4,i=10,s=/"id":"([0-9]+)"/g,o=/"nsid":"([0-9]+@N[0-9]+)"/g,u={photos:{},users:{}},a=new RegExp(e.config.flickr.api.write_api_method_regex),f={include:{"flickr.sharing.getServiceTypes":!0},exclude:{"flickr.sharing.getServices":!0,"flickr.sharing.canShare":!0,"flickr.sharing.getAuthorizeUrl":!0,"flickr.products.orders.getOrder":!0,"flickr.products.orders.applyCoupon":!0}};YUI.F=YUI.F||{},YUI.F.jsonCallbacks={},e.ClientTransport=n=function(){this.keys=n._keys},n._keys={csrf:null,siteKey:null},n.authorize=function(t){n._keys.siteKey=new e.SiteKey(null,t.flickrAPI),n._keys.siteKey.scheduleFutureFetch(),n._keys.csrf=new e.CsrfUpdater(t.flickrAPI),n._keys.csrf.scheduleFutureFetch()},e.ClientTransport.prototype={makeRequest:d,makeSiteKeyRequest:h,makeCsrfRequest:p}},"@VERSION@",{requires:["querystring-stringify","better-cache","io-xdr","site-key","csrf-updater","flickr-client-metrics","flickr-promise","flog"],affinity:"client"});
YUI.add("page-title-helper",function(e){e.pageTitleHelper=function(t){var n="Flickr - Photo Sharing!";return e.Lang.isString(t)&&(t=t.trim(),t&&(n=t+" | "+n)),n}},"@VERSION@",{requires:[]});
YUI.add("history-helper",function(e){e.HistoryHelper={setData:function(t,n,r){var i={};if(typeof history!="undefined"&&history.replaceState){typeof history.state!="undefined"&&history.state!==null&&typeof history.state.flickr!="undefined"&&(i=history.state.flickr),typeof i[t]=="undefined"&&(i[t]={}),i[t][n]=r;try{history.replaceState({flickr:i},"")}catch(s){}return!0}return e.Flog.warn("[history-helper] ["+t+"] Failed attempt to store history data for key: "+n),!1},getData:function(e,t){var n;if(typeof history!="undefined"&&typeof history.state!="undefined"&&history.state!==null&&typeof history.state.flickr!="undefined"){n=history.state.flickr[e];if(typeof n!="undefined"&&typeof n[t]!="undefined")return n[t]}return undefined}}},"@VERSION@",{requires:[]});
YUI.add("flickr-route",function(e){e.Routes=e.Routes||{},e.FlickrRoute=function(e){this.appContext=e,this.isMobile=!1},e.FlickrRoute.prototype={run:function(){},setRouteDataOnHistory:function(t,n){return e.HistoryHelper.setData(this.name,t,n)},getRouteDataFromHistory:function(t){return e.HistoryHelper.getData(this.name,t)},displayServerErrorOrClientRedirect:function(t,n,r){return YUI.Env.isServer?this.displayRouteErrors(t,new e.RouteError(404,n)):e.Promise.resolve({redirect:r||t.url})},detectRouteErrors:function(){var t=e.Array(arguments);return t.filter(function(t,n){return t instanceof e.RouteError}).sort(function(e,t){return e.type-t.type})},displayRouteErrors:function(t,n){var r=e.Lang.isArray(n)?n[0]:n;return e.Promise.resolve(this["display"+r.type+"Error"](t,r))},display500Error:function(t,n){var r,i,s;r={view:"error-500-page-view",params:{},headers:{statusCode:500},layout:"maximized"};if(e.config.flickr.error.show_debugging_info||t.isInsecureGod||this.appContext&&this.appContext.auth&&this.appContext.auth.isInsecureGod)r.params.source="flickrRoute#display500Error",r.params.message=n.message;return t.id&&(r.params.requestID=e.moment().format("YYYY-MM-DD")+"-"+t.id),n&&YUI.Env.isServer&&n.type==="SiteAuth"&&(n.redirect?(i=t.normalizedProtocol+"://"+t.headers.host+t.originalUrl,s=e.url("/siteauth/?redirect_url="+encodeURIComponent(i)),e.Flog.debug("Redirecting to siteauth "+(YUI.Env.onManhattan?"onManhattan":"notOnManhattan")),YUI.Env.onManhattan||(s+="&dev=1"),r={redirect:s}):r.params.siteAuthFailure=!0),typeof r.redirect=="undefined"?e.Flog.debug("[render]","[500] status=500",n.message,t.url):e.Flog.debug("[redirect]","[302] status=302",t.url," -> ",r.redirect),r},display303Error:function(e,t){return{redirect:t.options.redirect,headers:{statusCode:303}}},display403Error:function(t,n){var r;n=n||{},r={view:"error-403-page-view",params:{},headers:{statusCode:403},layout:"maximized"};if(e.config.flickr.error.show_debugging_info||t.isInsecureGod||this.appContext&&this.appContext.auth&&this.appContext.auth.isInsecureGod)r.params.source="flickrRoute#display403Error",r.params.message=n.message;return t.id&&(r.params.requestID=e.moment().format("YYYY-MM-DD")+"-"+t.id),r},display404Error:function(t,n){var r;n=n||{},r={view:"error-404-page-view",params:{},headers:{statusCode:404},layout:"maximized"},e.Flog.debug("[render]","[404] status=404",n.message,t.url);if(e.config.flickr.error.show_debugging_info||t.isInsecureGod||this.appContext&&this.appContext.auth&&this.appContext.auth.isInsecureGod)r.params.source="flickrRoute#display404Error",r.params.message=n.message;return t.id&&(r.params.requestID=e.moment().format("YYYY-MM-DD")+"-"+t.id),r},getPageNumber:function(e,t){var n=parseInt(e.params[t||"page_number"],10);if(isNaN(n)||n<=1)n=1;return n},isProcessedAsMobileRequest:function(e,t){return e.UA.isMobileBrowser&&!this.appContext.getCookie("mobile_allow_www")?(YUI.Env.isServer&&t.set("Vary","User-Agent"),!0):!1}},e.RouteError=function(e,t,n){this.type=e,this.message=t,this.options=n}},"@VERSION@",{requires:["flickr-promise","moment","fletrics","flog","url","history-helper"]});
YUI.add("mobile-redirect",function(e,t){function n(t,n){return YUI.Env.isServer?e.Lang.isValue(t.cookies[n]):e.Cookie.exists(n)}function r(t){return YUI.Env.isServer?t.headers["user-agent"]:e.UA.userAgent}function i(t,n){YUI.Env.isServer?t.redirect(n):e.config.win.location=n}e.mix(e.namespace("Middleware"),{MobileRedirect:function(s){return function(o,u,a){if(s.has_mdot!==!0)return e.Flog.debug("[%s] %s",t,"route does not have mdot version"),a();if(s.module==="shared-entity-route")return e.Flog.debug("[%s] %s",t,"guest passed page, going to photo page"),a();if(n(o,"mobile_allow_www"))return e.Flog.debug("[%s] %s",t,"user has the mobile opt-out cookie"),a();if(o.appContext.flipper.isFlipped("enable-new-mobile-photo-page")&&s.module==="photo-route"&&!e.BrowserSupport.isUnsupportedBrowser(r(o)))return e.Flog.debug("[%s] %s",t,"user can see reboot mobile photo page."),a();if(o.appContext.flipper.isFlipped("enable-new-mobile-tags-page")&&(s.module==="tags-route"||s.module==="tag-route"||s.module==="tags-day-route"||s.module==="tags-week-route")&&!e.BrowserSupport.isUnsupportedBrowser(r(o)))return e.Flog.debug("[%s] %s",t,"user can see reboot mobile tags pages."),a();e.BrowserSupport.isMobileBrowser(r(o))?(e.Flog.debug("[%s] %s",t,"mobile browser detected, redirecting"),e.Object.isEmpty(o.query)?i(u,"https://m.flickr.com"+o.path):i(u,"https://m.flickr.com"+o.path+"?"+e.QueryString.stringify(o.query))):(e.Flog.debug("[%s] %s",t,"not a mobile browser"),a())}}})},"@VERSION@",{requires:["querystring-stringify","browser-support","cookie","flog"]});
YUI.add("normalize-params-hash",function(e,t){e.mix(e.namespace("Middleware"),{NormalizeParamsHash:function(){return function(e,t,n){var r;if(!YUI.Env.isServer)for(r in e.params)e.params[r]=e.params[r][0];n()}}})},"@VERSION@",{requires:[]});
YUI.add("type-validator",function(e){function r(){var e;for(e in n)(function(){var r=n[e];t[e]=function(e){return r.test(e)}})()}var t={},n={nsid:/([0-9]+@N[0-9]+)/,pathAlias:/([0-9a-zA-Z-_]+)/,photoId:/[0-9]+/,bookId:/[0-9]+/,orderId:/[0-9]+/};r(),e.TypeValidator={matches:t}},"@VERSION@",{requires:[]});
YUI.add("normalize-param",function(e,t){e.mix(e.namespace("Middleware"),{NormalizeParam:function(t){return function(n,r,i){var s=n.params[t];if(!s||!e.Lang.isString(s))return i();e.TypeValidator.matches.nsid(s)||(n.params[t]=String(s).toLowerCase()),i()}}})},"@VERSION@",{requires:["type-validator"]});
YUI.add("normalize-path-params",function(e,t){e.mix(e.namespace("Middleware"),{NormalizePathParams:function(){return function(e,t,n){!YUI.Env.isServer&&e.params instanceof Array&&e.params.shift(),n()}}})},"@VERSION@",{requires:[]});
YUI.add("set-route-config",function(e,t){e.mix(e.namespace("Middleware"),{SetRouteConfig:function(t){return function(n,r,i){e.Lang.isObject(n.appContext)?(n.appContext.routeConfig=t,i()):i(new Error("appContext is undefined"))}}})},"@VERSION@",{requires:[]});
YUI.add("flickr-router",function(e){"use strict";var t,n,r;r="scrolling",e.FlickrRouter=function(e,n){return this.app=e,YUI.Env.isServer?(this.route=e.get.bind(e),this.render=t.server.bind(this)):(this.route=e.route.bind(e),this.render=t.client.bind(this)),this.setupRoutes(n),this},e.FlickrRouter.prototype={setupRoutes:function(e){var t,n,r,i,s;for(r in e.patterns)this.registerParam(r,new RegExp(e.patterns[r]));for(t=0;t<e.routes.length;t++){i=e.routes[t];if(i.path instanceof Array)for(n=0;n<i.path.length;n++){s={};for(r in i)r!=="path"&&(s[r]=i[r]);s.path=i.path[n],this.registerRoute(s)}else this.registerRoute(i)}},registerParam:function(e,t){YUI.Env.isServer?this.app.param(e,function(e,n,r,i,s){var o=t.exec(i);o?(e.params[s]=o[0],r()):r("route")}):this.app.param(e,t)},registerRoute:function(t){var r=this;this.route(t.path,function(t,n,r){!YUI.Env.isServer&&e.Flog&&e.Flog.time("[Routing to Activation]"),r()},function(e,t,n){!YUI.Env.isServer&&"appContext"in window&&(e.appContext=window.appContext),n()},e.Middleware.MobileRedirect(t),e.Middleware.NormalizeParamsHash(),e.Middleware.NormalizeParam("nsid_or_path_alias"),e.Middleware.NormalizePathParams(),e.Middleware.SetRouteConfig(t),function(e,i,s){return n.bounceRoute(e,i,s,t,r)},function(e,r,i){return n.checkOptIn(e,r,i,t)},function(e,r,i){return n.checkAndKick(e,r,i,t)},function(e,r,i){return n.mixInServerRequest(e,r,i,t)},function(e,i,s){return n.checkAndInterstitial(e,i,s,t,r)},function(e,n,i){r._processRequest(t,e,n,i)})},_processRequest:function(t,n,r,i){var s=this;n.transactionId=e.guid(),this.currentTransactionId=n.transactionId,n.appContext.startTime=Date.now(),n.appContext.getRoute(t.module).then(function(i){var o,u;return s.executingRoute=i,YUI.Env.isServer&&!t.skipAuth?o=YUI.Env.server.siteAuth.authenticate(n,r):o=e.when(null),u={id:n.id,isInsecureGod:n.isInsecureGod,cookies:n.cookies,headers:n.headers,params:n.params,url:n.url.toString(),query:n.query,buckets:n.buckets,lang:n.lang,probableUser:n.probableUser,UA:n.UA},n.isGod&&(u.isGod=n.isGod),YUI.Env.isServer&&YUI.Env.config.debug_request_timing&&(n.latencyTimerRouteStart=process.hrtime()),n.routeTimingStart=Date.now(),e.Promise.all([o,i.run(u,r)])}).then(function(t){return t.length>=2&&(n.appContext.initialView=t[1].view),t[1].isMobile?(e.Flog.debug("[flickr-router] route is being processed as mobile."),t[1].params||(t[1].params={}),t[1].params.isMobile=!0):e.Flog.debug("[flickr-router] route is being processed as desktop."),YUI.Env.isServer&&YUI.Env.config.debug_request_timing&&(n.latencyTimerViewStart=process.hrtime()),YUI.Env.isServer&&n.appContext&&n.appContext.flipper.isFlipped("enable-bots-server-rendering")&&(n.appContext.forceServerRender=n.appContext._doForcedServerRender()),s._renderView(t,n,r,i)}).then(null,function(e){return s._throwError.call(s,e,n,r,i)})},_renderView:function(t,n,i,s){var o=t.length>0?t[0]:null,u=t.length>1?t[1]:null,a;if(!u)throw new Error("Invalid viewConfig");if(o){o.signedIn&&o.user&&o.user.username?e.Flog.debug("[site auth]","["+o.user.nsid+"]",o.user.username._content+" is signed in."):e.Flog.debug("[site auth] user is signed out.");if(o.signedIn&&o.user)for(a in o.user)typeof YUI.Env.config.auth["whitelisted_keys"][a]=="undefined"&&delete o.user[a];o.isInsecureGod=n.isInsecureGod,n.appContext.auth=o,n.appContext.initCuratorTools()}return u&&typeof u.params!="undefined"&&(YUI.Env.isServer?u.params.isOwner=o&&o.signedIn&&o.user&&o.user.nsid===u.params.nsid:u.params.isOwner=n.appContext.getViewer().signedIn&&n.appContext.getViewer().nsid===u.params.nsid),u.redirect?this.render(n,i,u):(u.layout=u.layout||r,u.title=e.pageTitleHelper(u.title),YUI.Env.isServer&&YUI.Env.config.debug_request_timing&&(n.latencyTimerRenderStart=process.hrtime()),n.appContext.routeTiming=Date.now()-n.routeTimingStart,this.render(n,i,u))},_throwError:function(t,n,r,i){var s,o,u=n&&n.UA&&(n.UA.isBot||n.UA.isSharingBot),a=u?e.fletrics.getBotString():"",f=this;if(r.headersSent){e.Flog.debug("[flickr-router]","server render called but headers have already been sent","timeout="+(n.timeout?1:0));return}try{s=f.executingRoute.display500Error(n,t),o=f.render(n,r,s),YUI.Env.isServer&&t.type==="SiteAuth"?(e.fletrics.increment("siteauth.failures"),t.timeout&&e.fletrics.increment("api.timeouts"),t.failure&&e.fletrics.increment("api.other"),e.Flog.error("[site auth]",t.message)):(e.fletrics.increment("page.failures"),e.Flog.error("[router] Reboot page failure",t.message,n.url),t.fatal?t.timeout||t.clientTimeout?(e.fletrics.increment("api.timeouts"+a),e.Flog.error("Unexpected error: api.timeouts"+a+" | Error: ",t.message)):(e.fletrics.increment("api.other"+a),e.Flog.error("Unexpected error: api.other"+a+" | Error: ",t.message)):(e.fletrics.increment("page.failures.other"),e.Flog.error("Unexpected error: page.failures.other | Error: ",t.message+" | isBot: "+u)));if(e.config.win&&e.config.win.beaconError){t.panda=!0;var l="";n&&n.UA&&(l=" unsupported:"+n.UA.isUnsupportedBrowser+" "),e.config.win.beaconError("[flickr-router]"+l+t.message,e.config.win.location.href,t)}return o}catch(c){var h=c;typeof f.executingRoute=="undefined"&&(h=t);if(YUI.Env.isServer)i(h);else{e.Flog.log(t,t.stack);try{e.config.win&&e.config.win.beaconError&&(t.panda=!0,e.config.win.beaconError("[flickr-router] _throwError failed: "+t.message,e.config.win.location.href,t),h!==t&&e.config.win.beaconError(h.message,e.config.win.location.href,h))}catch(p){e.Flog.log("Failed trying to beacon client error.")}}}}},t={server:function(t,n,r){var i,s,o,u,a,f=!1,l="";if(n.headersSent){e.Flog.debug("[flickr-router]","server render called but headers have already been sent",r&&r.view?"view="+r.view:null,"isBot="+(f?1:0),"timeout="+(t.timeout?1:0));return}t&&t.UA&&(t.UA.isBot||t.UA.isSharingBot)&&(f=!0,l=e.fletrics.getBotString());if(!r)throw new Error("No view config provide to serverside renderer.");r.className="html-"+r.view,r.fluid&&(r.className+=" fluid"),r&&r.view&&["photo-page-scrappy-view","photo-page-lightbox-scrappy-view"
,"search-groups-page-view","search-people-page-view","books-view","books-cover-view","books-spread-view","products-order-view","products-order-shipping-view","products-order-payment-view","products-order-complete-view","subscriptions-order-view","subscriptions-order-payment-view","subscriptions-order-complete-view","mobile-photo-page-view","sohp-view","cameraroll-page-view","cameraroll-comingsoon-page-view","photostream-page-view","albums-list-page-view","album-page-view","favorites-page-view","explore-page-view","groups-list-page-view","group-home-page-view","group-pool-page-view","group-discussions-list-page-view","group-discussion-page-view","group-members-page-view","shared-entity-page-view","person-groups-page-view","stats-view","stats-allphotos-view"].indexOf(r.view)!==-1&&(o="page."+r.view.replace(/\-/g,".")+".requests"+l,e.fletrics.increment(o)),r.headers&&r.headers.statusCode&&n.status(r.headers.statusCode);if(r.redirect){n.redirect(r.redirect);return}if(r.json){n.send(r.json);return}return s=t.appContext.modelImportExport.exportAll(),u=e.mix({langBundles:["misc"],appContext:t.appContext},e.Localizable),t.appContext&&(a=t.appContext.flipper.isFlipped("disable-client-app")),t.appContext.flipper.prepareForExport(),i={viewName:r.view,viewParams:r.params,modelExport:s,modelRegistries:Object.keys(s),appContext:t.appContext,response:n,title:r.title,className:r.className,language:t.lang.toLowerCase(),layout:r.layout,isMobile:r.isMobile,darkLoader:r.darkLoader,siteName:u.intlMessage({intlName:"misc.DEFAULT_PAGE_TITLE"}),updatedDate:e.moment().toISOString(),clientAppErrorMessage:{oopsMsgTitle:u.intlMessage({intlName:"misc.OOPS"}),oopsMsgMain:u.intlMessage({intlName:"misc.LOADING_ERROR"}),oopsMsgFooter:u.intlMessage({intlName:"misc.REFRESH"})},disableClientApp:a},n.expose(t.appContext.auth,"window.auth"),n.expose(t.id,"window.reqId"),n.expose(t.lang,"window.YUI_config.lang"),n.on("finish",function(){var n,i,s,u={};YUI.Env.isServer&&YUI.Env.config.debug_request_timing&&t.latencyTimerStart&&t.latencyTimerRouteStart&&t.latencyTimerViewStart&&t.latencyTimerRenderStart&&(s={middleware:YUI.Env.server.diffHrtime(t.latencyTimerStart,t.latencyTimerRouteStart),route:YUI.Env.server.diffHrtime(t.latencyTimerRouteStart,t.latencyTimerViewStart),view:YUI.Env.server.diffHrtime(t.latencyTimerViewStart,t.latencyTimerRenderStart),render:YUI.Env.server.diffHrtime(t.latencyTimerRenderStart,process.hrtime())},u["1. Middleware"]=(s.middleware[0]*1e9+s.middleware[1])/1e6+" ms",u["2. Route"]=(s.route[0]*1e9+s.route[1])/1e6+" ms",u["3. View"]=(s.view[0]*1e9+s.view[1])/1e6+" ms",u["4. Render"]=(s.render[0]*1e9+s.render[1])/1e6+" ms",e.Flog.debug("[timing]","[waterfall]","isBot="+(f?1:0),u)),t.latencyTimerStart&&(n=process.hrtime(t.latencyTimerStart),n&&(i=(n[0]*1e9+n[1])/1e6,e.Flog.debug("[res]","view="+r.view,"isBot="+(f?1:0),"latency="+i),r&&r.view&&["photo-page-scrappy-view","photo-page-lightbox-scrappy-view","mobile-photo-page-view","sohp-view","cameraroll-page-view","cameraroll-comingsoon-page-view","photostream-page-view","albums-list-page-view","album-page-view","favorites-page-view","explore-page-view","groups-list-page-view","group-home-page-view","group-pool-page-view","group-discussions-list-page-view","group-discussion-page-view","group-members-page-view","shared-entity-page-view","person-groups-page-view","stats-view","stats-allphotos-view"].indexOf(r.view)!==-1&&(o="page."+r.view.replace(/\-/g,".")+".latency"+l,e.fletrics.set(o,i))))}),new e.Promise(function(e,t){n.emit("render"),n.render(r.view,i,function(r,i){r?t(r):(n.send(i),e(i))})})},client:function(t,n,r){var i=this,s;return r.redirect?(window.location=r.redirect,e.Promise.resolve()):(document.title=r.title,e.loaderBar.progress(),t.appContext.getView(r.view,r.params,r.layout).then(function(n){return e.loaderBar.progress(),s=n,s._params&&(s._params.keyEventScope=s.name+s._yuid),t.appContext.getKeyboardManager().setCurrentKeyEventScope(s.name+s._yuid),s.set("isRootView",!0),s.initialize()}).then(function(){var n,o;e.loaderBar.progress(),n=e.one("html"),o=n.get("className").trim(),o=o.replace(/html-[\S]+-view/,"html-"+r.view),o=o.replace(/[\S]+-layout/,r.layout+"-layout"),o=o.replace("fluid",""),o+=r.fluid?" fluid":"",n.set("className",o),t.transactionId===i.currentTransactionId&&(i.app.showView(s,null,{render:!0,callback:function(n){e.loaderBar.finish(),t.src!=="popstate"&&window.scroll(0,0)}}),!YUI.Env.isServer&&e.Flog&&e.Flog.timeEnd("[Routing to Activation]"))}).then(null,function(t){throw e.Flog.fatal("Client render had an error:",t.message,t.stack),t}))}},n={checkAndKick:function(e,t,n,r){if(YUI.Env.isServer){YUI.Env.server.bucketOptOut.checkAndKick(e,t,n,r);return}n()},checkAndInterstitial:function(e,t,n,r,i){var s;if(YUI.Env.isServer&&e.appContext.flipper.isFlipped("browser-upgrade-interstitial")&&e&&e.headers){s=e.get("referer")?e.get("referer"):"";if(e.UA.isReallyUnsupportedBrowser&&!e.UA.isBot&&!e.UA.isSharingBot&&e.url.indexOf("/browser/upgrade/")===-1&&s.indexOf("/browser/upgrade/")===-1)return t.redirect("/browser/upgrade/?continue="+encodeURIComponent(e.url))}n()},bounceRoute:function(t,n,r,i,s){var o;if(YUI.Env.isServer&&YUI.Env.onManhattan&&["gin.flickr.com","gin-flickr.com","staging.gin.flickr.com","staging-gin.flickr.com","smoke.gin.flickr.com","smoke-gin.flickr.com","dev.gin.flickr.com","dev-gin.flickr.com","dev2.gin.flickr.com","dev2-gin.flickr.com","perf.gin.flickr.com","perf-gin.flickr.com","perf2.gin.flickr.com","perf2-gin.flickr.com","perf3.gin.flickr.com","perf3-gin.flickr.com","spike.gin.flickr.com","spike-gin.flickr.com","qa.gin.flickr.com","qa-gin.flickr.com"].indexOf(t.headers.host)===-1&&!/user-[a-z]+.dev.gin.flickr.com/i.test(t.headers.host)&&!/[a-z0-9]+.dev.gin.flickr.com/i.test(t.headers.host)&&typeof i.optin=="undefined"&&(typeof i.public=="undefined"||!i.public)){e.Flog.error("[opt-in] no opt-in specified for "+i.module+" but we are not on gin.flickr.com or dev.gin.flickr.com, showing error page..."),o={view:"error-500-page-view"
,params:{},layout:"maximized"};if(e.config.flickr.error.show_debugging_info||t.isInsecureGod)o.params.source="flickrRouter#bounceRoute",o.params.message="[opt-in] no opt-in specified for "+i.module+" but we are not on gin.flickr.com or dev.gin.flickr.com, showing error page...";return t.id&&(o.params.requestID=e.moment().format("YYYY-MM-DD")+"-"+t.id),s.render(t,n,o)}r()},checkOptIn:function(t,n,r,i){var s,o;if(YUI.Env.isServer&&i.optin&&(!t.optins||t.optins.length===0||t.optins.indexOf(i.optin)===-1)){e.Flog.error("[opt-in] "+i.optin+" required for "+i.module+" but user has not opt-ed in to it, bouncing..."),s="https://"+t.headers.host+t.originalUrl,o=e.url(YUI.Env.config.optin.redirect_url+"?redirect_url="+encodeURIComponent(s)),YUI.Env.onManhattan||(o+="&dev=1"),n.redirect(o);return}r()},mixInServerRequest:function(t,n,r,i){YUI.Env.isServer||e.mix(t,e.namespace("config.flickr.request")),r()}}},"@VERSION@",{requires:["fletrics","flog","oop","page-title-helper","moment","flickr-route","localizable","url","mobile-redirect","normalize-params-hash","normalize-param","normalize-path-params","set-route-config"],langBundles:["misc"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("intl",function(e,t){var n={},r="yuiRootLang",i="yuiActiveLang",s=[];e.mix(e.namespace("Intl"),{_mod:function(e){return n[e]||(n[e]={}),n[e]},setLang:function(e,t){var n=this._mod(e),s=n[i],o=!!n[t];return o&&t!==s&&(n[i]=t,this.fire("intl:langChange",{module:e,prevVal:s,newVal:t===r?"":t})),o},getLang:function(e){var t=this._mod(e)[i];return t===r?"":t},add:function(e,t,n){t=t||r,this._mod(e)[t]=n,this.setLang(e,t)},get:function(t,n,r){var s=this._mod(t),o;return r=r||s[i],o=s[r]||{},n?o[n]:e.merge(o)},getAvailableLangs:function(t){var n=e.Env._loader,r=n&&n.moduleInfo[t],i=r&&r.lang;return i?i.concat():s}}),e.augment(e.Intl,e.EventTarget),e.Intl.publish("intl:langChange",{emitFacade:!0})},"3.16.0",{requires:["intl-base","event-custom"]});
YUI.add("hermes-lang-misc",function(e,t){e.Intl.add("hermes/misc","en-US",{ERROR:["Error!"],LOADING:["Loading"],DEFAULT_PAGE_TITLE:["Flickr - Photo Sharing!"],FLICKR:["Flickr"],OOPS:["Oops!"],LOADING_ERROR:["An issue occurred while loading."],REFRESH:["Please refresh the page."],UPLOADR_TEN_PHOTOS:["Uploadr - 10 photos ready to be viewed on your Flickr camera roll in the cloud"]})},"@VERSION@",{requires:["intl"]});
YUI.add("flickr-api-metrics",function(e){"use strict";var t=e.config.win,n="/beacon_client_api_timings.gne",r=new e.Samplr;e.FlickrAPIMetrics=function(){this.apiTimes=[];var i,s=this;e.config.flickr.client_metrics_samples&&e.config.flickr.client_metrics_samples.api_timings?i=r.isInSample(e.config.flickr.client_metrics_samples.api_timings):i=!0,i&&(e.on("client-transport:apiTime",function(e){s.beaconApiTiming(e)}),e.on("client-transport:apiError",function(r){var i={};r.apiMethod&&(i.m=r.apiMethod),r.reqId&&(i.reqId=r.reqId),r&&r.code?(i.e=r.code,t&&(i.a=(new Date).getTime()-t.sessionStart),e.RRD.queue(i,n)):r&&r.statusText==="timeout"&&(i.timeout=!0,e.config.flickr.api.hostname_client_https&&(i.api=e.config.flickr.api.hostname_client_https.replace(/https:\/\/|\//g,"")),e.RRD.queue(i,n))}),e.on("csrf:goodkey",function(r){e.RRD.queue({e:"goodcsrf",a:(new Date).getTime()-t.sessionStart},n)}),e.on("site-key:badkey",function(r){e.RRD.queue({e:"badsitekey",a:(new Date).getTime()-t.sessionStart},n)}),e.on("site-key:goodkey",function(r){e.RRD.queue({e:"goodsitekey",a:(new Date).getTime()-t.sessionStart},n)}))},e.FlickrAPIMetrics.prototype={beaconApiTiming:function(t){var i=this;if(e.config.flickr.client_metrics_samples&&e.config.flickr.client_metrics_samples.api_timings!=="undefined"){this.apiSample=r.isInSample(e.config.flickr.client_metrics_samples.api_timings);if(!this.apiSample)return}else this.apiSample=!0;this.apiTimes.push(t),this.beaconTimer&&clearTimeout(this.beaconTimer),this.beaconTimer=setTimeout(function(){var t,r,s;if(i.apiTimes.length<1)return;r="",s=[];for(t=i.apiTimes.length-1;t>=0;t--)s.push(i.apiTimes[t].method+";"+(i.apiTimes[t].end-i.apiTimes[t].start));r=s.join(":"),e.RRD.queue({d:r},n),i.apiTimes=[]},1e3)}}},"@VERSION@",{requires:["samplr","rrd"],affinity:"client"});
YUI.add("vendor-lighthouse",function(e,t){LH_start=+(new Date),function(e){"use strict";if(e.LH!==undefined&&e.LH.version!==undefined)return;var t="0.9",n=(window.location.protocol||document.location.protocol||"http:")+"//lh.secure.yahoo.com/lhbeam-"+t,r="root",i={beacon_url:n,timelines:{},tags:{},beaconNumber:0,navtimingBeaconSent:!1,beaconTimeout:10,onloadHandler:function(){setTimeout(i.onloadWorker,i.beaconTimeout)},onloadWorker:function(){var e=i.getPerformance();e.timing&&e.timing.loadEventEnd===0?setTimeout(i.onloadWorker,i.beaconTimeout):LH.beacon()},getBeaconUrl:function(){var t=this.beacon_url,n=e.document;return t?(t+=(t.indexOf("?")>-1?"&":"?")+"_uuid="+(this.uuid===null||this.uuid===undefined?"":encodeURIComponent(this.uuid)),t+="&_sid="+(this.spaceid===null||this.spaceid===undefined?"":encodeURIComponent(this.spaceid)),t+="&_sip="+(this.serverip===null||this.serverip===undefined?"":encodeURIComponent(this.serverip)),this.crumb&&(t+="&_crumb="+encodeURIComponent(this.crumb)),this.pvid&&(t+="&_pvid="+encodeURIComponent(this.pvid)),this.offset>0&&(t+="&offset="+this.offset),t+=(t.indexOf("?")>-1?"&":"?")+"u="+encodeURIComponent(n.URL.replace(/#.*/,"")),t):t},metrics:[],checkElemInMetrics:function(e){if(!i.metrics||i.metrics.length==0)return!0;for(var t in i.metrics)if(e===i.metrics[t])return!0;return!1},timelineFactory:function(e){return{state:0,name:e,startTime:parseInt(i.getPerformance().now()),dirty:!1,tags:{entries:{},toString:function(){var e="",t;for(t in this.entries){if(!this.entries.hasOwnProperty(t))continue;this.entries[t]===!0?e+="|t:"+t:e+="|t:"+t+","+this.entries[t]}return e}},type:{mark:{dirty:!1,entries:{},toString:function(){var e="",t,n;for(t in this.entries){if(!this.entries.hasOwnProperty(t)||!i.checkElemInMetrics(t))continue;e+="|m:"+t+",";for(n in this.entries[t])e+=this.entries[t][n].startTime+";"}return e}},measure:{dirty:!1,entries:{},toString:function(){var e="",t,n;for(t in this.entries){if(!this.entries.hasOwnProperty(t)||!i.checkElemInMetrics(t))continue;e+="|s:"+t+",";for(n in this.entries[t])e+=this.entries[t][n].startTime+","+this.entries[t][n].duration+";"}return e}},custom:{dirty:!1,entries:{},toString:function(){var e="",t,n;for(t in this.entries){if(!this.entries.hasOwnProperty(t)||!i.checkElemInMetrics(t))continue;e+="|r:"+t+",";for(n in this.entries[t])e+=this.entries[t][n].type+","+this.entries[t][n].startTime+","+this.entries[t][n].duration+";"}return e}}},toString:function(e){return e||(e=""),"c="+this.name+","+this.state+e+this.tags.toString()+e+this.type.mark.toString()+e+this.type.measure.toString()+e+this.type.custom.toString()}}},navTiming:function(){var e,t=i.getPerformance(),n,r,s,o;return t&&t.timing&&t.navigation&&(n=t.navigation,r=t.timing,o=r.navigationStart,s={navT:n.type,navS:o,fetS:r.fetchStart-o,dluS:r.domainLookupStart-o,dluE:r.domainLookupEnd-o,conS:r.connectStart-o,conE:r.connectEnd-o,reqS:r.requestStart-o,resS:r.responseStart-o,resE:r.responseEnd-o,domL:r.domLoading-o,domI:r.domInteractive-o,domS:r.domContentLoadedEventStart-o,domE:r.domContentLoadedEventEnd-o,domC:r.domComplete-o,lodS:r.loadEventStart-o,lodE:r.loadEventEnd-o},typeof r.linkNegotiationStart!="undefined"&&r.linkNegotiationStart!==0&&(s.lnkS=r.linkNegotiationStart-o),typeof r.linkNegotiationEnd!="undefined"&&r.linkNegotiationEnd!==0&&(s.lnkE=r.linkNegotiationEnd-o),r.unloadEventStart!==0&&(s.uldS=r.unloadEventStart-o,s.uldE=r.unloadEventEnd-o),r.redirectStart!==0&&(s.redC=n.redirectCount,s.redS=r.redirectStart-o,s.redE=r.redirectEnd-o),typeof r.secureConnectionStart=="number"&&(s.secS=r.secureConnectionStart>0?Math.max(1,r.secureConnectionStart-o):0),s.toString=function(t){var n="n=",r=0,s;if(i.hasOwnProperty("tags"))for(s in i.tags){if(!i.tags.hasOwnProperty(s))continue;n+=(r>0?"|":"")+"t:",i.tags[s]===!0?n+=s:n+=s+","+i.tags[s],r++}for(e in this){if(!this.hasOwnProperty(e)||e==="toString")continue;n+=(r>0?"|":"")+encodeURIComponent(e)+(this[e]===null||this[e]===undefined||parseInt(this[e])<=0?"":","+encodeURIComponent(this[e])),r++}return n}),s},offset:0,myNow:function(){return i.offset==0&&(i.offset=LH_start),+(new Date)-i.offset},getPerformance:function(){var t=e.performance||e.webkitPerformance||e.msPerformance||e.mozPerformance||e.Performance||{};return typeof t.now!="function"&&typeof t.webkitNow!="function"&&typeof t.msNow!="function"&&typeof t.mozNow!="function"&&(t.now=i.myNow),t.now=t.now||t.webkitNow||t.msNow||t.mozNow,t},getQueryParams:function(){var e={},t,n=/[?&]?([^=]+)=([^&]*)/g,r=window.location.search||document.location.search;r=r.split("+").join(" ");while(t=n.exec(r))e[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return e}};i.timelines.hasOwnProperty(r)||(i.timelines[r]=i.timelineFactory(r)),e.LH={t_start:LH_start,version:t,isInitialized:!1,init:function(t){var n,r,s=i.getQueryParams();t||(t={});for(n in t)t.hasOwnProperty(n)&&typeof t[n]!="function"&&(i[n]=t[n]);for(n in s)s.hasOwnProperty(n)&&typeof s[n]!="function"&&(i[n]=s[n]);return LH.isInitialized=!0,typeof t.log!="undefined"&&(this.log=t.log),this.log||(this.log=function(e,t,n){}),r=i.getPerformance(),r.timing&&r.timing.loadEventEnd==0?e.addEventListener?e.addEventListener("load",i.onloadHandler,!1):e.attachEvent&&e.attachEvent("onload",i.onloadHandler):i.onloadHandler(),this},metrics:function(e){typeof e=="string"?i.metrics=e.split(","):e instanceof Array&&(i.metrics=e)},newState:function(e){if(e!==undefined){if(!i.timelines.hasOwnProperty(e))throw new TypeError("Context not found");i.timelines.context.state++}e!=r&&i.timelines[r].state++},newContext:function(e){i.timelines.hasOwnProperty(e)||(i.timelines[e]=i.timelineFactory(e))},tag:function(e,t){var n,s=r,o;t&&(n=t.val),t&&typeof t.context=="string"&&(s=t.context),o=i.timelines[s],n!==undefined?o.tags.entries[e]=n:o.tags.entries[e]=!0},mark:function(e,t){var n=r,s,o,u,a;if(!e)throw new TypeError("Not enough arguments");return t&&typeof t.context=="string"&&(n=t.context),s=i.timelines[n],o=s.type.mark,u=o.entries,u[e]||
(u[e]=[]),a={duration:0,entryType:"mark",name:e,startTime:parseInt(i.getPerformance().now())},u[e].push(a),o.dirty=!0,s.dirty=!0,a},measure:function(e,t){var n,s,o=r,u,a,f,l=[],c={name:e,entryType:"measure"},h,p;t&&(n=typeof t.startMark=="string"?t.startMark:n,s=typeof t.endMark=="string"?t.endMark:s,a=typeof t.startMark=="object"?t.startMark:null,f=typeof t.endMark=="object"?t.endMark:null,o=typeof t.context=="string"?t.context:o),u=i.timelines[o],h=u.type.measure,p=h.entries;if(!e)throw new TypeError("Not enough arguments");if((s||f)&&!n&&!a)throw new SyntaxError("No startMark provided with endMark");if(n||a){n&&(l=u.type.mark.entries[n]);if(!a&&l instanceof Array&&l.length>0)a=l[l.length-1];else if(!a)throw new SyntaxError("startMark not found");c.startTime=a.startTime;if(s||f){s&&(l=u.type.mark.entries[s]);if(!f&&l instanceof Array&&l.length>0)f=l[l.length-1];else if(!f)throw new SyntaxError("endMark not found");c.duration=f.startTime-a.startTime}else c.duration=parseInt(i.getPerformance().now())-a.startTime}else c.startTime=0,c.duration=parseInt(i.getPerformance().now());return p[e]||(p[e]=[]),p[e].push(c),h.dirty=!0,u.dirty=!0,c},record:function(e,t,n){var s=r,o,u,a;return n&&typeof n.context=="string"&&(s=n.context),o=i.timelines[s],u=o.type.custom,a=u.entries,a[e]||(a[e]=[]),a[e].push(t),u.dirty=!0,o.dirty=!0,t},clearMarks:function(e){var t=r,n,s,o;e&&typeof e.context=="string"&&(t=e.context),n=i.timelines[t],s=n.type.mark,o=s.entries,e&&typeof e.name=="string"?o[name]&&(o[name].length=0,s.dirty=!0,n.dirty=!0):(s.entries={},s.dirty=!0,n.dirty=!0)},clearMeasures:function(e){var t=r,n,s,o;e&&typeof e.context=="string"&&(t=e.context),n=i.timelines[t],s=n.type.measure,o=s.entries,e&&typeof e.name=="string"?o[name]&&(o[name].length=0,s.dirty=!0,n.dirty=!0):(s.entries={},s.dirty=!0,n.dirty=!0)},clearCustomEntries:function(e){var t=r,n,s,o;e&&typeof e.context=="string"&&(t=e.context),n=i.timelines[t],s=n.type.custom,o=s.entries,e&&typeof e.name=="string"?o[name]&&(o[name].length=0,s.dirty=!0,n.dirty=!0):(s.entries={},s.dirty=!0,n.dirty=!0)},clearTags:function(e){var t=r,n;e&&typeof e.context=="string"&&(t=e.context),n=i.timelines[t],e&&typeof e.name=="string"?n.tags.entries[name]&&(delete n.tags.entries[name],n.dirty=!0):(n.tags.entries={},n.dirty=!0)},beacon:function(e){var t,n,s,o,u,a=r,f,l,c,h,p,d,v=i.LH_debug&&(i.LH_debug===!0||i.LH_debug==="true"||i.LH_debug==="1");i.hasOwnProperty("spaceid")&&(t=i.spaceid),i.hasOwnProperty("serverip")&&(n=i.serverip),i.hasOwnProperty("pvid")&&(s=i.pvid),i.hasOwnProperty("crumb")&&(o=i.crumb),e&&e.hasOwnProperty("spaceid")&&(i.spaceid=e.spaceid),e&&e.hasOwnProperty("serverip")&&(i.serverip=e.serverip),e&&e.hasOwnProperty("pvid")&&(i.pvid=e.pvid),e&&e.hasOwnProperty("crumb")&&(i.crumb=e.crumb),u=i.getBeaconUrl(),t&&(i.spaceid=t),n&&(i.serverip=n),s&&(i.pvid=s),o&&(i.crumb=o);if(v){d=i.getPerformance();if(d.getEntriesByType){f=d.getEntriesByType("resource"),console.log("Resources present: "+f.length);for(p in f)(f[p].name.indexOf("lh-")>=0||f[p].name.indexOf("lighthouse")>=0)&&console.log("Time for lighthouse resource",f[p])}}return u?(i.navtimingBeaconSent||(l=i.navTiming(),l&&l.lodE>0&&(u+=(u.indexOf("?")>-1?"&":"?")+i.navTiming().toString(),i.navtimingBeaconSent=!0)),e&&typeof e.context=="string"&&(a=e.context),c=i.timelines[a],u+=(u.indexOf("?")>-1?"&":"?")+c.toString(),v&&console.log("beacon url: "+u),i.beaconNumber++,h=new Image,v&&(h.onload=h.onerror=h.onabort=function(e){var t=e;return function(){var e=LH.mark("LH.endBeacon"),n=LH.measure("LH.beacon",{startMark:t,endMark:e});console.log("beacon response received",n)}}(LH.mark("LH.startBeacon"))),h.src=u,e&&e.clearMarks&&this.clearMarks(),e&&e.clearMeasures&&this.clearMeasures(),e&&e.clearCustomEntries&&this.clearCustomEntries(),e&&e.clearTags&&this.clearTags(),this):this}}}(window)},"@VERSION@",{affinity:"client"});
YUI.add("lighthouse",function(e){"use strict";var t=e.config.win,n,r=new e.Samplr;!t||!t.LH?e.Flog.warn("Missing Lighthouse vendor JS!"):n=t.LH,e.config.flickr.lighthouse_samples||e.Flog.warn("Missing Lighthouse sampling rates"),e.Lighthouse=function(t){this.hasData=!1;var n=0,i=t.pageId,s=t.signedIn,o=e.config.flickr.lighthouse_samples;n=o["default"],o[i]&&(n=typeof o[i]=="object"?o[i][s?"signedIn":"signedOut"]:o[i]);if(r.isInSample(n)){this.isActive=!0;try{this.initialize(t)}catch(u){e.Flog.warn("Lighthouse failed to initialize")}}else e.Flog.log("Lighthouse did not initialize because the request is not in the sample")},e.Lighthouse.prototype={initialize:function(r){var i,s,o,u,a;a={uuid:r.uuid,spaceid:r.spaceId,serverip:r.hostname,pvid:111111,crumb:"AXAXYBGH123",tags:{b:"reboot"}},window.appContext.flipper.isFlipped("enable-lighthouse-edge-timing")&&(a.via=e.config.flickr.via),e.config.flickr.pathogen?a.tags.b="pathogen":e.config.flickr.cdnUrls&&(a.tags.b="YCS_https"),r.signedIn&&(a.tags.l=!0),n.init(a),t.performance&&t.performance.timing&&(s=t.performance.timing),r.paft&&t.paftTiming&&t.paftTiming.final&&s&&(o=t.paftTiming.final-s.navigationStart,n.record("AFT",{name:"AFT",type:"mark",startTime:o,duration:0}),n.record("AFT_SV",{name:"AFT_SV",type:"mark",startTime:o,duration:0}),n.beacon({spaceid:r.spaceId,clearMarks:!0,clearMeasures:!0,clearCustomEntries:!0,clearTags:!0})),t.pageTiming&&t.pageTiming.timeAboveTheFold&&t.pageTiming.timeAboveTheFold>0&&s&&(u=t.pageTiming.timeAboveTheFold-s.navigationStart,n.record("AFT",{name:"AFT",type:"mark",startTime:u,duration:0}),n.record("AFT_SV",{name:"AFT_SV",type:"mark",startTime:u,duration:0}),n.beacon({spaceid:r.spaceId,clearMarks:!0,clearMeasures:!0,clearCustomEntries:!0,clearTags:!0})),i=r.clientMetrics;if(!i)throw new Error("No client metrics found");i.on("metrics:page_start",this.handlePageStart.bind(this)),i.on("metrics:js_done",this.handleJSDone.bind(this)),i.on("metrics:mark",this.handleMark.bind(this)),i.on("metrics:record",this.handleRecord.bind(this)),i.on("metrics:beacon",this.handleBeacon.bind(this)),i.on("metrics:abort",this.abort.bind(this)),i.on("metrics:mark_start",this.handleMarkStart.bind(this)),i.on("metrics:mark_end",this.handleMarkEnd.bind(this))},abort:function(e){n.clearMarks(),n.clearMeasures(),n.clearCustomEntries(),n.clearTags(),this.hasData=!1},handlePageStart:function(e){n.mark("mark_unload"),this.hasData=!0},handleJSDone:function(e){try{n.mark("mark_fully_loaded"),n.measure("js_done",{startMark:"mark_unload",endMark:"mark_fully_loaded"})}catch(e){this.abort()}},handleMark:function(e){if(e.markName)try{var t;n.mark(e.markName),t=n.measure(e.markName,{startMark:"mark_unload",endMark:e.markName}),t.type=t.entryType,n.record(e.markName,{name:e.markName,type:"mark",startTime:t.duration,duration:0}),this.hasData=!0}catch(e){this.abort()}},handleRecord:function(e){if(e.markName&&e.timestamp)try{n.record(e.markName,{name:e.markName,type:"mark",startTime:e.timestamp,duration:0}),this.hasData=!0}catch(e){this.abort()}},handleMarkStart:function(e){if(e.markName)try{if(!!this.markedStart)return;this.markedStart=e,n.mark(e.markName+"_start")}catch(e){this.abort()}},handleMarkEnd:function(t){if(t.markName&&this.markedStart){if(this.markedStart.photoId!==t.photoId)return;try{n.mark(t.markName+"_end"),n.measure(t.markName,{startMark:t.markName+"_start",endMark:t.markName+"_end"})}catch(t){e.Flog.warn("Lighthouse: not able to measure: ",t),this.abort()}this.markedStart=null}},handleBeacon:function(t){if(this.hasData){var r={clearMeasures:!0,clearCustomEntries:!0,clearMarks:!0};e.config.flickr.pathogen?n.tag("b","pathogen"):e.config.flickr.cdnUrls?n.tag("b","YCS_https"):n.tag("b","reboot"),t.data&&(t.data.spaceid&&(r.spaceid=t.data.spaceid),t.data.is_logged_in&&n.tag("l",1)),n.clearMarks(),n.beacon(r),this.hasData=!1}}}},"@VERSION@",{requires:["vendor-lighthouse","samplr"],affinity:"client"});
YUI.add("comscore",function(e,t){function n(e){var t="comScore=",n=document,r=n.cookie,i="",s="indexOf",o="substring",u="length",a=2048,f,l="&ns_",c="&",h,p,d,v,m=window,g=m.encodeURIComponent||escape;if(r[s](t)+1)for(d=0,p=r.split(";"),v=p[u];d<v;d++)h=p[d][s](t),h+1&&(i=c+unescape(p[d][o](h+t[u])));e+=l+"_t="+ +(new Date)+l+"c="+(n.characterSet||n.defaultCharset||"")+i,e[u]>a&&e[s](c)>0&&(f=e[o](0,a-8).lastIndexOf(c),e=(e[o](0,f)+l+"cut="+g(e[o](f+1)))[o](0,a)),n.images?(h=new Image,m.ns_p||(ns_p=h),h.src=e):n.write("<","p","><",'img src="',e,'" height="1" width="1" alt="*"',"><","/p",">")}typeof _comscore=="undefined"&&(_comscore=[]),function(){var e="length",t=self,r=t.encodeURIComponent?encodeURIComponent:escape,i=".scorecardresearch.com",s=Math,o="script",u="width",a=/c2=(\d*)&/,f,l=function(t){if(!!t){var s,o=[],u,a=0,f,l,c="";for(var h in t){u=typeof t[h];if(u=="string"||u=="number")o[o[e]]=h+"="+r(t[h]),h=="c2"?c=t[h]:h=="c1"&&(a=1)}if(o[e]<=0||c=="")return;l=t.options||{},l.d=l.d||document;if(typeof l.url_append=="string"){f=l.url_append.replace(/&amp;/,"&").split("&");for(var h=0,p=f[e],v;h<p;h++)v=f[h].split("="),v[e]==2&&(o[o[e]]=v[0]+"="+r(v[1]))}s=["http",l.d.URL.charAt(4)=="s"?"s://sb":"://b",i,"/p?",a?"":"c1=2&",o.join("&").replace(/&$/,"")],n(s.join(""))}},c=function(t){t=t||_comscore;for(var n=0,r=t[e];n<r;n++)l(t[n]);t=_comscore=[]};c(),(f=t.COMSCORE)?(f.purge=c,f.beacon=l):COMSCORE={purge:c,beacon:l}}(),e.comscore=COMSCORE},"@VERSION@",{affinity:"client"});
YUI.add("loader-bar",function(e){if(YUI.Env.isServer){e.loaderBar={start:function(){},progress:function(){},finish:function(){}};return}e.use("node","dom",function(e){function o(){r=!0,t=100*Math.random(),t=t>20?t:20,i?i.setStyle("display","block"):(i=e.Node.create('<div class="loader-bar">'),e.one("body").append(i)),i.setStyle("width",t+"px"),n=setInterval(function(){t=i.get("offsetWidth"),t>=e.config.win.innerWidth-5&&(i.setStyle("display","none"),clearInterval(n),r=!1)},100)}var t=0,n,r=!1,i=null,s;e.loaderBar={start:function(){if(r)return;clearTimeout(s),s=setTimeout(o,60)},progress:function(){if(!r)return;t+=Math.round(e.config.win.innerWidth*Math.random()*.5),i.setStyle("width",t+"px")},finish:function(){clearTimeout(s);if(!r)return;i.setStyle("width",e.config.win.innerWidth+"px")}}})},"@VERSION@",{requires:[]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("pluginhost-base",function(e,t){function r(){this._plugins={}}var n=e.Lang;r.prototype={plug:function(e,t){var r,i,s;if(n.isArray(e))for(r=0,i=e.length;r<i;r++)this.plug(e[r]);else e&&!n.isFunction(e)&&(t=e.cfg,e=e.fn),e&&e.NS&&(s=e.NS,t=t||{},t.host=this,this.hasPlugin(s)?this[s].setAttrs&&this[s].setAttrs(t):(this[s]=new e(t),this._plugins[s]=e));return this},unplug:function(e){var t=e,r=this._plugins;if(e)n.isFunction(e)&&(t=e.NS,t&&(!r[t]||r[t]!==e)&&(t=null)),t&&(this[t]&&(this[t].destroy&&this[t].destroy(),delete this[t]),r[t]&&delete r[t]);else for(t in this._plugins)this._plugins.hasOwnProperty(t)&&this.unplug(t);return this},hasPlugin:function(e){return this._plugins[e]&&this[e]},_initPlugins:function(e){this._plugins=this._plugins||{},this._initConfigPlugins&&this._initConfigPlugins(e)},_destroyPlugins:function(){this.unplug()}},e.namespace("Plugin").Host=r},"3.16.0",{requires:["yui-base"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("pluginhost-config",function(e,t){var n=e.Plugin.Host,r=e.Lang;n.prototype._initConfigPlugins=function(t){var n=this._getClasses?this._getClasses():[this.constructor],r=[],i={},s,o,u,a,f;for(o=n.length-1;o>=0;o--)s=n[o],a=s._UNPLUG,a&&e.mix(i,a,!0),u=s._PLUG,u&&e.mix(r,u,!0);for(f in r)r.hasOwnProperty(f)&&(i[f]||this.plug(r[f]));t&&t.plugins&&this.plug(t.plugins)},n.plug=function(t,n,i){var s,o,u,a;if(t!==e.Base){t._PLUG=t._PLUG||{},r.isArray(n)||(i&&(n={fn:n,cfg:i}),n=[n]);for(o=0,u=n.length;o<u;o++)s=n[o],a=s.NAME||s.fn.NAME,t._PLUG[a]=s}},n.unplug=function(t,n){var i,s,o,u;if(t!==e.Base){t._UNPLUG=t._UNPLUG||{},r.isArray(n)||(n=[n]);for(s=0,o=n.length;s<o;s++)i=n[s],u=i.NAME,t._PLUG[u]?delete t._PLUG[u]:t._UNPLUG[u]=i}}},"3.16.0",{requires:["pluginhost-base"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("node-pluginhost",function(e,t){e.Node.plug=function(){var t=e.Array(arguments);return t.unshift(e.Node),e.Plugin.Host.plug.apply(e.Base,t),e.Node},e.Node.unplug=function(){var t=e.Array(arguments);return t.unshift(e.Node),e.Plugin.Host.unplug.apply(e.Base,t),e.Node},e.mix(e.Node,e.Plugin.Host,!1,null,1),e.Object.each(e.Node._instances,function(t){e.Plugin.Host.apply(t)}),e.NodeList.prototype.plug=function(){var t=arguments;return e.NodeList.each(this,function(n){e.Node.prototype.plug.apply(e.one(n),t)}),this},e.NodeList.prototype.unplug=function(){var t=arguments;return e.NodeList.each(this,function(n){e.Node.prototype.unplug.apply(e.one(n),t)}),this}},"3.16.0",{requires:["node-base","pluginhost"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("dom-screen",function(e,t){(function(e){var t="documentElement",n="compatMode",r="position",i="fixed",s="relative",o="left",u="top",a="BackCompat",f="medium",l="borderLeftWidth",c="borderTopWidth",h="getBoundingClientRect",p="getComputedStyle",d=e.DOM,v=/^t(?:able|d|h)$/i,m;e.UA.ie&&(e.config.doc[n]!=="BackCompat"?m=t:m="body"),e.mix(d,{winHeight:function(e){var t=d._getWinSize(e).height;return t},winWidth:function(e){var t=d._getWinSize(e).width;return t},docHeight:function(e){var t=d._getDocSize(e).height;return Math.max(t,d._getWinSize(e).height)},docWidth:function(e){var t=d._getDocSize(e).width;return Math.max(t,d._getWinSize(e).width)},docScrollX:function(n,r){r=r||n?d._getDoc(n):e.config.doc;var i=r.defaultView,s=i?i.pageXOffset:0;return Math.max(r[t].scrollLeft,r.body.scrollLeft,s)},docScrollY:function(n,r){r=r||n?d._getDoc(n):e.config.doc;var i=r.defaultView,s=i?i.pageYOffset:0;return Math.max(r[t].scrollTop,r.body.scrollTop,s)},getXY:function(){return e.config.doc[t][h]?function(r){var i=null,s,o,u,f,l,c,p,v,g,y;if(r&&r.tagName){p=r.ownerDocument,u=p[n],u!==a?y=p[t]:y=p.body,y.contains?g=y.contains(r):g=e.DOM.contains(y,r);if(g){v=p.defaultView,v&&"pageXOffset"in v?(s=v.pageXOffset,o=v.pageYOffset):(s=m?p[m].scrollLeft:d.docScrollX(r,p),o=m?p[m].scrollTop:d.docScrollY(r,p)),e.UA.ie&&(!p.documentMode||p.documentMode<8||u===a)&&(l=y.clientLeft,c=y.clientTop),f=r[h](),i=[f.left,f.top];if(l||c)i[0]-=l,i[1]-=c;if(o||s)if(!e.UA.ios||e.UA.ios>=4.2)i[0]+=s,i[1]+=o}else i=d._getOffset(r)}return i}:function(t){var n=null,s,o,u,a,f;if(t)if(d.inDoc(t)){n=[t.offsetLeft,t.offsetTop],s=t.ownerDocument,o=t,u=e.UA.gecko||e.UA.webkit>519?!0:!1;while(o=o.offsetParent)n[0]+=o.offsetLeft,n[1]+=o.offsetTop,u&&(n=d._calcBorders(o,n));if(d.getStyle(t,r)!=i){o=t;while(o=o.parentNode){a=o.scrollTop,f=o.scrollLeft,e.UA.gecko&&d.getStyle(o,"overflow")!=="visible"&&(n=d._calcBorders(o,n));if(a||f)n[0]-=f,n[1]-=a}n[0]+=d.docScrollX(t,s),n[1]+=d.docScrollY(t,s)}else n[0]+=d.docScrollX(t,s),n[1]+=d.docScrollY(t,s)}else n=d._getOffset(t);return n}}(),getScrollbarWidth:e.cached(function(){var t=e.config.doc,n=t.createElement("div"),r=t.getElementsByTagName("body")[0],i=.1;return r&&(n.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;",n.appendChild(t.createElement("p")).style.height="1px",r.insertBefore(n,r.firstChild),i=n.offsetWidth-n.clientWidth,r.removeChild(n)),i},null,.1),getX:function(e){return d.getXY(e)[0]},getY:function(e){return d.getXY(e)[1]},setXY:function(e,t,n){var i=d.setStyle,a,f,l,c;e&&t&&(a=d.getStyle(e,r),f=d._getOffset(e),a=="static"&&(a=s,i(e,r,a)),c=d.getXY(e),t[0]!==null&&i(e,o,t[0]-c[0]+f[0]+"px"),t[1]!==null&&i(e,u,t[1]-c[1]+f[1]+"px"),n||(l=d.getXY(e),(l[0]!==t[0]||l[1]!==t[1])&&d.setXY(e,t,!0)))},setX:function(e,t){return d.setXY(e,[t,null])},setY:function(e,t){return d.setXY(e,[null,t])},swapXY:function(e,t){var n=d.getXY(e);d.setXY(e,d.getXY(t)),d.setXY(t,n)},_calcBorders:function(t,n){var r=parseInt(d[p](t,c),10)||0,i=parseInt(d[p](t,l),10)||0;return e.UA.gecko&&v.test(t.tagName)&&(r=0,i=0),n[0]+=i,n[1]+=r,n},_getWinSize:function(r,i){i=i||r?d._getDoc(r):e.config.doc;var s=i.defaultView||i.parentWindow,o=i[n],u=s.innerHeight,a=s.innerWidth,f=i[t];return o&&!e.UA.opera&&(o!="CSS1Compat"&&(f=i.body),u=f.clientHeight,a=f.clientWidth),{height:u,width:a}},_getDocSize:function(r){var i=r?d._getDoc(r):e.config.doc,s=i[t];return i[n]!="CSS1Compat"&&(s=i.body),{height:s.scrollHeight,width:s.scrollWidth}}})})(e),function(e){var t="top",n="right",r="bottom",i="left",s=function(e,s){var o=Math.max(e[t],s[t]),u=Math.min(e[n],s[n]),a=Math.min(e[r],s[r]),f=Math.max(e[i],s[i]),l={};return l[t]=o,l[n]=u,l[r]=a,l[i]=f,l},o=e.DOM;e.mix(o,{region:function(e){var t=o.getXY(e),n=!1;return e&&t&&(n=o._getRegion(t[1],t[0]+e.offsetWidth,t[1]+e.offsetHeight,t[0])),n},intersect:function(u,a,f){var l=f||o.region(u),c={},h=a,p;if(h.tagName)c=o.region(h);else{if(!e.Lang.isObject(a))return!1;c=a}return p=s(c,l),{top:p[t],right:p[n],bottom:p[r],left:p[i],area:(p[r]-p[t])*(p[n]-p[i]),yoff:p[r]-p[t],xoff:p[n]-p[i],inRegion:o.inRegion(u,a,!1,f)}},inRegion:function(u,a,f,l){var c={},h=l||o.region(u),p=a,d;if(p.tagName)c=o.region(p);else{if(!e.Lang.isObject(a))return!1;c=a}return f?h[i]>=c[i]&&h[n]<=c[n]&&h[t]>=c[t]&&h[r]<=c[r]:(d=s(c,h),d[r]>=d[t]&&d[n]>=d[i]?!0:!1)},inViewportRegion:function(e,t,n){return o.inRegion(e,o.viewportRegion(e),t,n)},_getRegion:function(e,s,o,u){var a={};return a[t]=a[1]=e,a[i]=a[0]=u,a[r]=o,a[n]=s,a.width=a[n]-a[i],a.height=a[r]-a[t],a},viewportRegion:function(t){t=t||e.config.doc.documentElement;var n=!1,r,i;return t&&(r=o.docScrollX(t),i=o.docScrollY(t),n=o._getRegion(i,o.winWidth(t)+r,i+o.winHeight(t),r)),n}})}(e)},"3.16.0",{requires:["dom-base","dom-style"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("node-screen",function(e,t){e.each(["winWidth","winHeight","docWidth","docHeight","docScrollX","docScrollY"],function(t){e.Node.ATTRS[t]={getter:function(){var n=Array.prototype.slice.call(arguments);return n.unshift(e.Node.getDOMNode(this)),e.DOM[t].apply(this,n)}}}),e.Node.ATTRS.scrollLeft={getter:function(){var t=e.Node.getDOMNode(this);return"scrollLeft"in t?t.scrollLeft:e.DOM.docScrollX(t)},setter:function(t){var n=e.Node.getDOMNode(this);n&&("scrollLeft"in n?n.scrollLeft=t:(n.document||n.nodeType===9)&&e.DOM._getWin(n).scrollTo(t,e.DOM.docScrollY(n)))}},e.Node.ATTRS.scrollTop={getter:function(){var t=e.Node.getDOMNode(this);return"scrollTop"in t?t.scrollTop:e.DOM.docScrollY(t)},setter:function(t){var n=e.Node.getDOMNode(this);n&&("scrollTop"in n?n.scrollTop=t:(n.document||n.nodeType===9)&&e.DOM._getWin(n).scrollTo(e.DOM.docScrollX(n),t))}},e.Node.importMethod(e.DOM,["getXY","setXY","getX","setX","getY","setY","swapXY"]),e.Node.ATTRS.region={getter:function(){var t=this.getDOMNode(),n;return t&&!t.tagName&&t.nodeType===9&&(t=t.documentElement),e.DOM.isWindow(t)?n=e.DOM.viewportRegion(t):n=e.DOM.region(t),n}},e.Node.ATTRS.viewportRegion={getter:function(){return e.DOM.viewportRegion(e.Node.getDOMNode(this))}},e.Node.importMethod(e.DOM,"inViewportRegion"),e.Node.prototype.intersect=function(t,n){var r=e.Node.getDOMNode(this);return e.instanceOf(t,e.Node)&&(t=e.Node.getDOMNode(t)),e.DOM.intersect(r,t,n)},e.Node.prototype.inRegion=function(t,n,r){var i=e.Node.getDOMNode(this);return e.instanceOf(t,e.Node)&&(t=e.Node.getDOMNode(t)),e.DOM.inRegion(i,t,n,r)}},"3.16.0",{requires:["dom-screen","node-base"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("node-style",function(e,t){(function(e){e.mix(e.Node.prototype,{setStyle:function(t,n){return e.DOM.setStyle(this._node,t,n),this},setStyles:function(t){return e.DOM.setStyles(this._node,t),this},getStyle:function(t){return e.DOM.getStyle(this._node,t)},getComputedStyle:function(t){return e.DOM.getComputedStyle(this._node,t)}}),e.NodeList.importMethod(e.Node.prototype,["getStyle","getComputedStyle","setStyle","setStyles"])})(e);var n=e.Node;e.mix(n.prototype,{show:function(e){return e=arguments[arguments.length-1],this.toggleView(!0,e),this},_show:function(){this.removeAttribute("hidden"),this.setStyle("display","")},_isHidden:function(){return this.hasAttribute("hidden")||e.DOM.getComputedStyle(this._node,"display")==="none"},toggleView:function(e,t){return this._toggleView.apply(this,arguments),this},_toggleView:function(e,t){return t=arguments[arguments.length-1],typeof e!="boolean"&&(e=this._isHidden()?1:0),e?this._show():this._hide(),typeof t=="function"&&t.call(this),this},hide:function(e){return e=arguments[arguments.length-1],this.toggleView(!1,e),this},_hide:function(){this.setAttribute("hidden","hidden"),this.setStyle("display","none")}}),e.NodeList.importMethod(e.Node.prototype,["show","hide","toggleView"])},"3.16.0",{requires:["dom-style","node-base"]});
